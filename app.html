<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>App Filmes</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <style>
      pre {
        padding: 19px;
        background-color: #ccc;
        border-radius: 10px;
        margin: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <pre id="debug">

      </pre>
      <h1>Filmes</h1>
      <form class="jumbotron">
        <div class="row">
          <div class="col-4">
            <label>Titulo</label>
            <input onkeyup="atualizarDados()" type="text" class="form-control" placeholder="Titulo" id="titulo" />
          </div>
          <div class="col-3">
            <label>Link</label>
            <input onkeyup="atualizarDados()" type="url" class="form-control" placeholder="URL" id="link" />
          </div>
          <div class="col-3">
            <label>Categoria</label>
            <select id="categoria" onchange="atualizarDados()" class="form-control">
              <option>Categoria 1</option>
              <option>Categoria 2</option>
              <option>Categoria 3</option>
            </select>
          </div>
          <div class="col-2">
            <label>Ano</label>
            <input id="ano" onkeyup="atualizarDados()" type="number" class="form-control" />
          </div>
        </div>
        <br />
        <a href="javascript:void(0)" onclick="cadastrar()" class="btn btn-lg btn-block btn-success"
          >Salvar</a
        >
      </form>
      <table class="table table-striped">
        <thead>
          <tr>
            <td scape="col">Nome</td>
            <td scape="col">Categoria</td>
            <td scape="col">Ano</td>
            <thscope="col">Ações</thscope=>
          </tr>
        </thead>
        <tbody id="lista_filmes">
        </tbody>
      </table>
    </div>
  </body>
  <script type="text/javascript">

    document.addEventListener('click',(e)=>{
     const listaClasse = Array.prototype.slice.call(e.target.classList);
     if (e.target && listaClasse.includes('acessarFilme')) {
      const url = e.target.dataset.url;
      window.open(url, '_blank');
     }

     if (e.target && listaClasse.includes('excluirFilme')) {
      const id = e.target.dataset.id;
      document.getElementById(id).remove();
     }
    });

    let dados = {
      titulo:"",
      ano: 0,
      categoria: "",
      link: "",
    };

    const atualizarDados = () =>{
      dados = {
        titulo: document.getElementById("titulo").value,
        ano: document.getElementById("ano").value,
        categoria: document.getElementById("categoria").value,
        link: document.getElementById("link").value,
      };
          document.getElementById("debug").innerHTML = JSON.stringify(dados);
  };
  
    const montarItem = () => {
      const id = new Date().getTime();

       const item =`
          <tr id="${id}">
            <td>${dados.titulo}</td>
            <td>${dados.categoria}</td>
            <td>${dados.ano}</td>
            <td class="text-right">
              <button class="btn btn-info acessarFilme" data-url="${dados.link}">acessar</button>
              <button class="btn btn-danger excluirFilme " data-id="${id}">Excluir</button>
            </td>
            </tr>`;

      return item;
    }
  
    const cadastrar = () => {
      document.getElementById("lista_filmes").insertAdjacentHTML('beforeEnd', montarItem());
      dados = {};
    }
  
  </script>
</html>
